<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Usuários de Teste via REST</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .avatar {
      border-radius: 8px;
      width: 100%;
      height: 220px;
      object-fit: cover;
    }
  </style>
</head>
<body class="container bg-warning">
  <h1 class="mt-4 mb-2 text-center text-dark">Usuários de Teste via REST</h1>
  <p class="text-center mb-4 text-dark" style="font-style: italic;">
    Os usuários deste exemplo são fornecidos pela API de testes
    <a href="https://reqres.in/" target="_blank" style="color:#000; text-decoration:underline;">reqres.in</a>
  </p>

  <div id="app" class="container-fluid">
    <div class="d-flex justify-content-center align-items-center gap-2 my-3">
      <button class="btn btn-dark" @click="prevPage" :disabled="loading || page<=1">Anterior</button>
      <div class="text-dark">Página {{page}} / {{total_pages}}</div>
      <button class="btn btn-dark" @click="nextPage" :disabled="loading || page>=total_pages">Próxima</button>
      <button class="btn btn-outline-dark" @click="reload" :disabled="loading">Recarregar</button>
      <div v-if="loading" class="spinner-border text-dark" role="status" aria-hidden="true"></div>
    </div>

    <div v-if="error" class="alert alert-danger text-center" role="alert">{{ error }}</div>

    <div class="row justify-content-center">
      <div class="col-md-4 col-lg-3" v-for="(user, index) in users" :key="user.id">
        <div class="card m-3 p-2">
          <img :src="user.avatar" class="card-img-top avatar" :alt="user.first_name">
          <div class="card-body">
            <h5 class="card-title">{{user.first_name}} {{user.last_name}}</h5>
            <p class="card-text">{{user.email}}</p>
          </div>
        </div>
      </div>
    </div>

    <div v-if="!loading && users.length===0 && !error" class="text-center text-dark my-5">Nenhum usuário encontrado.</div>
  </div>

  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script>
    const { createApp } = Vue;
    createApp({
      data() {
        return {
          users: [],
          page: 1,
          total_pages: 1,
          loading: false,
          error: null
        };
      },
      methods: {
        loadUsers(page = 1) {
          this.loading = true;
          this.error = null;
          fetch(`https://reqres.in/api/users?page=${page}&per_page=9`, {
            method: 'GET',
            headers: {
              'x-api-key': 'reqres-free-v1',
              'Accept': 'application/json'
            }
          })
            .then(res => {
              if (!res.ok) throw new Error(`HTTP ${res.status}`);
              return res.json();
            })
            .then(data => {
              this.users = data.data || [];
              this.page = data.page || page;
              this.total_pages = data.total_pages || 1;
            })
            .catch(err => {
              console.error('Erro ao carregar usuários:', err);
              this.error = 'Não foi possível carregar os usuários. Verifique sua conexão ou tente recarregar.';
            })
            .finally(() => {
              this.loading = false;
            });
        },
        prevPage() {
          if (this.page > 1) this.loadUsers(this.page - 1);
        },
        nextPage() {
          if (this.page < this.total_pages) this.loadUsers(this.page + 1);
        },
        reload() {
          this.loadUsers(this.page);
        }
      },
      mounted() {
        this.loadUsers(1);
      }
    }).mount('#app');
  </script>
</body>
  <!-- Ícone flutuante do GitHub -->
  <a href="https://github.com/biel-cosso" class="github-float" target="_blank" title="Meu GitHub">
    <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" alt="GitHub">
  </a>
</html>
